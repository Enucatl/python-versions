#!/usr/bin/env bash
# Options: <output-dir>

set -e
set -x

OUT_PREFIX=$1

echo "Building SQLite..."
./parts/sqlite $OUT_PREFIX

echo "Building Mercurial..."
./parts/mercurial

echo "Building pyenv..."
git clone git://github.com/yyuu/pyenv.git .pyenv
export PYENV_ROOT="$(pwd)/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init -)"

echo "Building Python..."
pyenv install stackless-3.3-dev
pyenv rehash

which python
which pip
./parts/hdf5
./parts/build-requirements
